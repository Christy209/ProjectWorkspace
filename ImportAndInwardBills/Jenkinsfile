pipeline {
    agent any

    environment {
        MAVEN_HOME = "C:\\apache-maven-3.9.10\\bin\\mvn"
    }

    stages {

        stage('Init') {
            steps {
                script {
                    echo "üü¢ Selected Branch  : main"
                    echo "üü¢ Selected TestCase: TC01_LodgeTheBillUsingImportandInwardMenu"
                }
            }
        }

        stage('Checkout') {
            steps {
                checkout([
                    $class: 'GitSCM',
                    branches: [[name: '*/main']],
                    doGenerateSubmoduleConfigurations: false,
                    extensions: [],
                    userRemoteConfigs: [[
                        url: 'https://github.com/Christy209/ProjectWorkspace.git'
                    ]]
                ])
            }
        }

        stage('Build') {
            steps {
                script {
                    echo "üî® Running Maven Build..."
                    bat "${MAVEN_HOME} clean install -f %WORKSPACE%\\ImportAndInwardBills\\pom.xml"
                }
            }
        }

        stage('Run Tests') {
            steps {
                script {
                    echo "üß™ Running TestCase: TC01_LodgeTheBillUsingImportandInwardMenu"
                    bat "${MAVEN_HOME} test -f %WORKSPACE%\\ImportAndInwardBills\\pom.xml -Dtest=TC01_LodgeTheBillUsingImportandInwardMenu"
                }
            }
        }

        stage('Post Steps') {
            steps {
                script {
                    echo "‚úÖ Pipeline completed successfully!"
                }
            }
        }
    }

    post {
        success {
            echo "üéâ Build and tests ran successfully!"
        }
        failure {
            echo "‚ùå Pipeline failed. Check logs for details."
        }
    }
}
